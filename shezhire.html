<!DOCTYPE html>
<html lang="kk">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>üå≥ “ö—ã–ø—à–∞“õ –†—É –®–µ–∂—ñ—Ä–µ—Å—ñ</title>
    <style>
        /* –ù–µ–≥—ñ–∑–≥—ñ —Å—Ç–∏–ª—å–¥–µ—Ä –∂”ô–Ω–µ “õ–∞–∑–∞“õ—ã —ç–ª–µ–º–µ–Ω—Ç—Ç–µ—Ä */
        @import url('https://fonts.googleapis.com/css2?family=Noto+Sans:wght@400;600;700&display=swap');
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Noto Sans', Arial, sans-serif;
            background: linear-gradient(135deg, #1a4b5c 0%, #2d5a3d 50%, #8B4513 100%);
            min-height: 100vh;
            padding: 20px;
            line-height: 1.6;
        }

        /* –ë–∞—Å—Ç—ã —Ç–∞“õ—ã—Ä—ã–ø */
        .header {
            text-align: center;
            margin-bottom: 40px;
            padding: 30px 20px;
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            border-radius: 20px;
            border: 2px solid rgba(255, 215, 0, 0.3);
        }

        .main-title {
            font-size: clamp(2rem, 5vw, 3.5rem);
            color: #FFD700;
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.8);
            margin-bottom: 10px;
            font-weight: 700;
        }

        .subtitle {
            font-size: clamp(1rem, 3vw, 1.3rem);
            color: #F5DEB3;
            font-style: italic;
        }

        /* –ê“ì–∞—à –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ñ */
        .tree-container {
            max-width: 1200px;
            margin: 0 auto;
            background: rgba(255, 255, 255, 0.05);
            backdrop-filter: blur(10px);
            border-radius: 20px;
            padding: 30px;
            border: 2px solid rgba(255, 215, 0, 0.2);
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
        }

        /* –ê“ì–∞—à —ç–ª–µ–º–µ–Ω—Ç—Ç–µ—Ä—ñ–Ω—ñ“£ –Ω–µ–≥—ñ–∑–≥—ñ —Å—Ç–∏–ª—ñ */
        .tree-node {
            margin-left: 0;
            list-style: none;
        }

        .tree-node ul {
            margin-left: 30px;
            list-style: none;
            max-height: 0;
            overflow: hidden;
            transition: max-height 0.4s ease-in-out, opacity 0.3s ease;
            opacity: 0;
        }

        .tree-node ul.expanded {
            max-height: 2000px;
            opacity: 1;
        }

        /* –ê—Ç–∞ –∞—Ç—Ç–∞—Ä—ã–Ω—ã“£ –±–∞—Ç—ã—Ä–º–∞–ª–∞—Ä—ã */
        .ancestor-button {
            display: flex;
            align-items: center;
            width: 100%;
            padding: 12px 20px;
            margin: 8px 0;
            background: linear-gradient(145deg, rgba(255, 215, 0, 0.8), rgba(218, 165, 32, 0.7));
            border: none;
            border-radius: 15px;
            color: #2c1810;
            font-weight: 600;
            font-size: clamp(0.9rem, 2.5vw, 1.1rem);
            cursor: pointer;
            transition: all 0.3s cubic-bezier(0.25, 0.46, 0.45, 0.94);
            text-align: left;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.2);
            position: relative;
            overflow: hidden;
        }

        /* –ñ—ã–ª—Ç—ã—Ä —ç—Ñ—Ñ–µ–∫—Ç—ñ—Å—ñ */
        .ancestor-button::before {
            content: '';
            position: absolute;
            top: -50%;
            left: -50%;
            width: 200%;
            height: 200%;
            background: linear-gradient(45deg, transparent, rgba(255, 255, 255, 0.3), transparent);
            transform: rotate(45deg);
            transition: all 0.6s;
            opacity: 0;
        }

        .ancestor-button:hover::before {
            animation: shimmer 1s ease-in-out;
            opacity: 1;
        }

        @keyframes shimmer {
            0% { transform: translateX(-100%) translateY(-100%) rotate(45deg); }
            100% { transform: translateX(100%) translateY(100%) rotate(45deg); }
        }

        .ancestor-button:hover {
            transform: translateY(-3px) scale(1.02);
            background: linear-gradient(145deg, rgba(255, 215, 0, 0.95), rgba(218, 165, 32, 0.85));
            box-shadow: 0 8px 25px rgba(255, 215, 0, 0.4);
        }

        .ancestor-button:active {
            transform: translateY(-1px) scale(0.98);
        }

        /* + –∂”ô–Ω–µ - –∏–∫–æ–Ω–∫–∞–ª–∞—Ä—ã */
        .toggle-icon {
            margin-right: 10px;
            font-size: 1.2rem;
            font-weight: bold;
            color: #8B4513;
            min-width: 20px;
            text-align: center;
            transition: transform 0.3s ease;
        }

        .ancestor-button.expanded .toggle-icon {
            transform: rotate(180deg);
        }

        /* –ë–∞–ª–∞–ø–∞–Ω —ç–ª–µ–º–µ–Ω—Ç—Ç–µ—Ä—ñ (“±—Ä–ø–∞“õ—Ç–∞—Ä) */
        .child-node .ancestor-button {
            background: linear-gradient(145deg, rgba(245, 222, 179, 0.9), rgba(222, 184, 135, 0.8));
            font-size: clamp(0.85rem, 2.3vw, 1rem);
            padding: 10px 18px;
        }

        .child-node .ancestor-button:hover {
            background: linear-gradient(145deg, rgba(245, 222, 179, 1), rgba(222, 184, 135, 0.95));
            box-shadow: 0 6px 20px rgba(222, 184, 135, 0.4);
        }

        /* –ù–µ–º–µ—Ä–µ —ç–ª–µ–º–µ–Ω—Ç—Ç–µ—Ä—ñ */
        .grandchild-node .ancestor-button {
            background: linear-gradient(145deg, rgba(240, 230, 140, 0.8), rgba(189, 183, 107, 0.7));
            font-size: clamp(0.8rem, 2.1vw, 0.95rem);
            padding: 8px 16px;
        }

        .grandchild-node .ancestor-button:hover {
            background: linear-gradient(145deg, rgba(240, 230, 140, 0.95), rgba(189, 183, 107, 0.85));
            box-shadow: 0 4px 15px rgba(240, 230, 140, 0.4);
        }

        /* –ë–∞—Å“õ–∞—Ä—É –±–∞—Ç—ã—Ä–º–∞–ª–∞—Ä—ã */
        .controls {
            margin-bottom: 20px;
            text-align: center;
        }

        .control-button {
            background: linear-gradient(145deg, rgba(0, 123, 255, 0.8), rgba(0, 86, 179, 0.7));
            color: white;
            border: none;
            padding: 10px 20px;
            margin: 5px;
            border-radius: 10px;
            cursor: pointer;
            font-weight: 600;
            transition: all 0.3s ease;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.2);
        }

        .control-button:hover {
            background: linear-gradient(145deg, rgba(0, 123, 255, 0.95), rgba(0, 86, 179, 0.85));
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(0, 123, 255, 0.4);
        }

        /* –ê–¥–∞–ø—Ç–∏–≤—Ç—ñ–∫ —Å—Ç–∏–ª—å–¥–µ—Ä */
        @media (max-width: 768px) {
            .tree-container {
                padding: 20px;
                margin: 10px;
            }

            .tree-node ul {
                margin-left: 20px;
            }

            .ancestor-button {
                padding: 15px;
                font-size: 1rem;
            }

            .toggle-icon {
                font-size: 1.1rem;
            }
        }

        @media (max-width: 480px) {
            body {
                padding: 10px;
            }

            .tree-container {
                padding: 15px;
                margin: 5px;
            }

            .tree-node ul {
                margin-left: 15px;
            }

            .ancestor-button {
                padding: 12px;
                font-size: 0.95rem;
            }

            .header {
                padding: 20px 15px;
            }
        }

        /* –ñ“±–º—ã—Å —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞—Å—ã */
        .stats {
            margin-top: 30px;
            text-align: center;
            background: rgba(255, 255, 255, 0.05);
            backdrop-filter: blur(10px);
            border-radius: 15px;
            padding: 20px;
            border: 1px solid rgba(255, 215, 0, 0.2);
        }

        .stats h3 {
            color: #FFD700;
            margin-bottom: 15px;
            font-size: 1.3rem;
        }

        .stats p {
            color: #F5DEB3;
            margin: 8px 0;
            font-size: 1rem;
        }

        /* –ö—ñ—Ä—É –∞–Ω–∏–º–∞—Ü–∏—è—Å—ã */
        .fade-in {
            opacity: 0;
            transform: translateY(20px);
            animation: fadeInUp 0.6s ease-out forwards;
        }

        @keyframes fadeInUp {
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }
    </style>
</head>

<body>
    <!-- –ë–∞—Å—Ç—ã —Ç–∞“õ—ã—Ä—ã–ø –±”©–ª—ñ–º—ñ -->
    <div class="header fade-in">
        <h1 class="main-title">üå≥ “ö—ã–ø—à–∞“õ –†—É –®–µ–∂—ñ—Ä–µ—Å—ñ</h1>
        <p class="subtitle">–ê—Ç–∞-–±–∞–±–∞–ª–∞—Ä—ã–º—ã–∑–¥—ã“£ —Ç–∞–º—ã—Ä —Ç–∞—Ä–∏—Ö—ã</p>
    </div>

    <!-- –ë–∞—Å“õ–∞—Ä—É –±–∞—Ç—ã—Ä–º–∞–ª–∞—Ä—ã -->
    <div class="controls fade-in">
    <button class="control-button" onclick="expandAll()">üåø –ë–∞—Ä–ª—ã“ì—ã–Ω –∞—à—É</button>
    <button class="control-button" onclick="collapseAll()">üå≥ –ë–∞—Ä–ª—ã“ì—ã–Ω –∂–∞–±—É</button>
    <button class="control-button" onclick="resetTree()">üîÑ “ö–∞–ª–ø—ã–Ω–∞ –∫–µ–ª—Ç—ñ—Ä—É</button>
    <button class="control-button" onclick="goBack()">‚¨ÖÔ∏è –ê—Ä—Ç“õ–∞ “õ–∞–π—Ç—É</button>
</div>

<script>
function goBack() {
    window.history.back();
}
</script>


    <!-- –ê“ì–∞—à –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ñ -->
    <div class="tree-container fade-in">
        <ul id="ancestorTree" class="tree-node">
            <!-- JavaScript –∞—Ä“õ—ã–ª—ã –¥–∏–Ω–∞–º–∏–∫–∞–ª—ã“õ —Ç“Ø—Ä–¥–µ “õ“±—Ä—ã–ª–∞–¥—ã -->
        </ul>
    </div>

    <!-- –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –±”©–ª—ñ–º—ñ -->
    <div class="stats fade-in">
        <h3>üìä –®–µ–∂—ñ—Ä–µ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞—Å—ã</h3>
        <p id="totalAncestors">–ñ–∞–ª–ø—ã –∞—Ç–∞ —Å–∞–Ω—ã: <span>0</span></p>
        <p id="expandedNodes">–ê—à—ã–ª“ì–∞–Ω —Ç–∞—Ä–º–∞“õ—Ç–∞—Ä: <span>0</span></p>
        <p id="treeDepth">–ê“ì–∞—à —Ç–µ—Ä–µ“£–¥—ñ–≥—ñ: <span>0</span> –¥–µ“£–≥–µ–π</p>
    </div>

    <script>
        // –®–µ–∂—ñ—Ä–µ –¥–µ—Ä–µ–∫—Ç–µ—Ä—ñ–Ω—ñ“£ –Ω–µ–≥—ñ–∑–≥—ñ –º–∞—Å—Å–∏–≤—ñ - –Ω–∞“õ—Ç—ã “õ—ã–ø—à–∞“õ —Ä—É —à–µ–∂—ñ—Ä–µ—Å—ñ
const ancestorData = {
  name: "“ö–∞—Ä–∞“õ—ã–ø—à–∞“õ",
  children: [
    {
      name: "“∞–∑—ã–Ω",
      children: [
        { name: "–ê–ª—Ç—ã–±–∞—Å", children: [] },
        {
          name: "–ê–ª—Ç—ã—Å",
          children: [
            {
              name: "–ë”©–∫–µ–π",
              children: [
                {
                  name: "“ö–∞–∑",
                  children: [
                    {
                      name: "–ù–∞—É—Ä—ã–∑",
                      children: [
                        {
                          name: "–ï–ª—à—ñ–±–µ–∫",
                          children: [
                            { name: "”ò–ª–∫–µ–π", children: [] },
                            { name: "–ú–∞–ª–∞–π", children: [] },
                            { name: "”®—Ç–µ–ø–±–µ—Ä–ª—ñ", children: [] },
                            { name: "–ê–¥–∞—Å", children: [] },
                            { name: "–®—É—ã–ª–¥–∞“õ", children: [] },
                            { name: "–ê—Ç–∫–µ–ª—Ç—ñ—Ä", children: [] },
                            {
                              name: "–ï–ª–µ–Ω–±”©—Ä—ñ",
                              children: [
                                { name: "“ö—ã–¥—ã—Ä", children: [] },
                                {
                                  name: "–ë–∞–∑–∞—Ä",
                                  children: [
                                    {
                                      name: "–°–∞—Å—ã“õ",
                                      children: [
                                        {
                                          name: "–ö“Ø–Ω–±–∞—Å",
                                          children: [
                                            {
                                              name: "–ù“±—Ä–∂–∞–Ω",
                                              children: [
                                                {
                                                  name: "“ö–∞–ª–∏",
                                                  children: [
                                                    {
                                                      name: "”ò—Å–∫–µ—Ä–±–µ–∫",
                                                      children: [
                                                        {
                                                          name: "–ü–µ—Ä–Ω–µ–±–∞–π",
                                                          children: [
                                                            { name: "–°“Ø–Ω–¥–µ—Ç", children: [] },
                                                            { name: "–î–∏—è—Å", children: [] },
                                                            { name: "–ò–ª—è—Å", children: [] }
                                                          ]
                                                        },
                                                        {
                                                          name: "–ù“±—Ä–ª—ã–±–∞–π",
                                                          children: [
                                                            { name: "–ê–±–∞–π", children: [] },
                                                            { name: "–ê–±—ã–ª–∞–π", children: [] },
                                                            { name: "–ñ–∞–Ω–∫–µ–ª–¥—ñ", children: [] }
                                                          ]
                                                        },
                                                        {
                                                          name: "“í–∞–∑–∏–∑",
                                                          children: [
                                                            { name: "”ò–ª–∏ (–∂.)", children: [] },
                                                            { name: "–ò–º—Ä–∞–Ω", children: [] },
                                                            { name: "–û—Å–º–∞–Ω", children: [] }
                                                          ]
                                                        }
                                                      ]
                                                    },
                                                    {
                                                      name: "”ò–∫—ñ–º–±–µ–∫",
                                                      children: [
                                                        { name: "–¢–µ–º—É—Ä", children: [] },
                                                        { name: "–ï—Ä–∫—ñ–Ω–±–µ–∫", children: [] }
                                                      ]
                                                    }
                                                  ]
                                                },
                                                {
                                                  name: "–Ü–±—ñ—à",
                                                  children: [
                                                    { name: "–ú–∞“õ—Å–∞—Ç (–∂.)", children: [] }
                                                  ]
                                                },
                                                {
                                                  name: "–ù“±“ì–º–∞–Ω",
                                                  children: [
                                                    {
                                                      name: "–°–∞–π–ª–∞—É",
                                                      children: [
                                                        {
                                                          name: "–ó–µ–π–Ω–µ–ª“ì–∞–±–¥–µ–Ω",
                                                          children: [
                                                            { name: "–ú–∞“õ—Å–∞—Ç (–∂.)", children: [] },
                                                            { name: "–ú“±—Ä–∞—Ç", children: [
                                                              { name: "–ë–µ–∫–∑–∞—Ç", children: [] }, 
                                                              { name: "–û—Ä–∞–ª–±–µ–∫", children: [] }
                                                            ]},
                                                            { name: "–ë–µ–∫–±–æ–ª–∞—Ç", children: [] },
                                                            { name: "–ñ–∞–Ω–±–æ–ª–∞—Ç", children: [] }
                                                          ]
                                                        },
                                                        {
                                                          name: "–ñ–µ“£—ñ—Å–±–µ–∫",
                                                          children: [
                                                            { name: "–†–∞–º–∞–∑–∞–Ω", children: [] }
                                                          ]
                                                        },
                                                        {
                                                          name: "–ê–∑–∏–∑",
                                                          children: [
                                                            { name: "–ù“±—Ä“ì–∏—Å–∞", children: [] },
                                                            { name: "–ù“±—Ä“ì–∞–ª–∏", children: [] },
                                                            { name: "–ù“±—Ä”ô–ª–∏", children: [] }
                                                          ]
                                                        }
                                                      ]
                                                    }
                                                  ]
                                                },
                                                {
                                                  name: "”ò–±—ñ–ª",
                                                  children: [
                                                    {
                                                      name: "”ò–±–∏–±—É–ª–ª–∞",
                                                      children: [
                                                        {
                                                          name: "–ë–µ—Ä—ñ–∫",
                                                          children: [
                                                            {
                                                              name: "“í–∞–±–∏–±—É–ª–ª–∞",
                                                              children: [
                                                                { name: "–û–º–∞—Ä", children: [] }
                                                              ]
                                                            },
                                                            { name: "–°–∞–º“±—Ä–∞—Ç", children: [] }
                                                          ]
                                                        },
                                                        {
                                                          name: "”ò–ª—ñ–±–∏",
                                                          children: [
                                                            { name: "–ù“±—Ä–∑–∞—Ç", children: [] },
                                                            { name: "”ò–ª–∏—Ö–∞–Ω", children: [] },
                                                            { name: "–ê–±–¥—É–∞–ª–∏", children: [] }
                                                          ]
                                                        },
                                                        {
                                                          name: "–ú–µ–¥–µ—Ç",
                                                          children: [
                                                            { name: "–ù“±—Ä—Å–∞—è—Ç", children: [] },
                                                            { name: "–ò–ª—å—è—Å", children: [] }
                                                          ]
                                                        }
                                                      ]
                                                    },
                                                    {
                                                      name: "–°–µ—Ä—ñ–∫",
                                                      children: [
                                                        {
                                                          name: "–°–∞–º–∞—Ç",
                                                          children: [
                                                            { name: "–°–∞—É—Ä–∞–Ω", children: [] },
                                                            { name: "“ö–∞–ª“õ–∞–º–∞–Ω", children: [] }
                                                          ]
                                                        },
                                                        { name: "”ò–¥—ñ–ª–∂–∞–Ω", children: [] }
                                                      ]
                                                    }
                                                  ]
                                                }
                                              ]
                                            },
                                            {
                                              name: "–ï—Å—ñ–º",
                                              children: [
                                                { name: "–†–∞—Ö–º–µ—Ç (–∂.)", children: [] }
                                              ]
                                            }
                                          ]
                                        },
                                        {
                                          name: "–ó–æ—Ä–º“±—Ä—ã–Ω",
                                          children: [
                                            {
                                              name: "–¢–∞—Å—ã–º",
                                              children: [
                                                {
                                                  name: "”ò–±–∂–∞–Ω",
                                                  children: [
                                                    { name: "–ï—Ä–≥–µ—à (–∂.)", children: [] },
                                                    {
                                                      name: "–ê—Ä—ã–Ω",
                                                      children: [
                                                        {
                                                          name: "–ë–µ–π—Å–µ–Ω–±–µ–∫",
                                                          children: [
                                                            {
                                                              name: "–£–∞–ª–∏—Ö–∞–Ω",
                                                              children: [
                                                                { name: "–ê–π–±–µ–∫", children: [] },
                                                                { name: "–ê–π–¥–æ—Å", children: [] },
                                                                { name: "–ê–π–¥—ã–Ω", children: [] }
                                                              ]
                                                            },
                                                            {
                                                              name: "–î”ô—É–ª–µ—Ç",
                                                              children: [
                                                                {
                                                                  name: "–ú“±—Ö—Ç–∞—Ä—Ö–∞–Ω",
                                                                  children: [
                                                                    { name: "–ú–∞–Ω—Å“±—Ä", children: [] }
                                                                  ]
                                                                },
                                                                { name: "–ë–µ–π–±–∞—Ä—ã—Å", children: [] }
                                                              ]
                                                            },
                                                            {
                                                              name: "“í–∞–Ω–∏",
                                                              children: [
                                                                { name: "–ê–∑–∞–º–∞—Ç", children: [] },
                                                                { name: "–ê–±–¥—É–ª–ª–∞", children: [] }
                                                              ]
                                                            },
                                                            {
                                                              name: "“í–∞–ª—ã–º",
                                                              children: [
                                                                { name: "–ê–ª–∏—Å“±–ª—Ç–∞–Ω", children: [] },
                                                                { name: "–ë–µ–∫—Å“±–ª—Ç–∞–Ω", children: [] },
                                                                { name: "–ê“£—Å–∞—Ä", children: [] }
                                                              ]
                                                            }
                                                          ]
                                                        },
                                                        {
                                                          name: "–î“Ø–π—Å–µ–Ω–±–µ–∫",
                                                          children: [
                                                            { name: "–ë–∞—É—ã—Ä–∂–∞–Ω", children: [] },
                                                            { name: "–ï—Ä–º–∞—Ö–∞–Ω", children: [] }
                                                          ]
                                                        },
                                                        {
                                                          name: "–ù“±—Ä—Ç–∞–∑–∞",
                                                          children: [
                                                            {
                                                              name: "–†—É—Å–ª–∞–Ω",
                                                              children: [
                                                                { name: "–û–º–∞—Ä", children: [] },
                                                                { name: "”ò–Ω—É–∞—Ä", children: [] }
                                                              ]
                                                            },
                                                            {
                                                              name: "–ï—Ä–∂–∞–Ω",
                                                              children: [
                                                                { name: "–ò–º—Ä–∞–Ω", children: [] },
                                                                { name: "–•–∞–º–∑–∞", children: [] },
                                                                { name: "–û—Å–º–∞–Ω", children: [] }
                                                              ]
                                                            }
                                                          ]
                                                        },
                                                        {
                                                          name: "–ú–µ–π—Ä–∞–º–±–µ–∫",
                                                          children: [
                                                            {
                                                              name: "–ë–∞“õ—ã—Ç–∂–∞–Ω",
                                                              children: [
                                                                { name: "–î–∞–Ω–∏—è–ª", children: [] },
                                                                { name: "–†–∞–º–∞–∑–∞–Ω", children: [] }
                                                              ]
                                                            },
                                                            {
                                                              name: "–ñ“Ø—Å—ñ–ø",
                                                              children: [
                                                                { name: "–î–∞–Ω–∏—è—Ä", children: [] },
                                                                { name: "–ê–ª–¥–∏—è—Ä", children: [] },
                                                                { name: "–ê–ª–∏—Ö–∞–Ω", children: [] },
                                                                { name: "–ê–±–¥—É—Ä–∞—Ö–º–∞–Ω", children: [] }
                                                              ]
                                                            },
                                                            {
                                                              name: "–ù“±—Ä—Å“±–ª—Ç–∞–Ω",
                                                              children: [
                                                                { name: "–ê–ª–∏–Ω“±—Ä", children: [] },
                                                                { name: "–ê–±—É–±–∞–∫–∏—Ä", children: [] }
                                                              ]
                                                            },
                                                            { name: "–ë–µ–∫–∑–∞—Ç", children: [] }
                                                          ]
                                                        }
                                                      ]
                                                    }
                                                  ]
                                                }
                                              ]
                                            },
                                            { name: "–®”©–º–µ–Ω–±–∞–π", children: [{ name: "–°–∞“ì—ã–Ω–¥—ã“õ (–∂.)", children: [] }] }
                                          ]
                                        }
                                      ]
                                    },
                                    {
                                      name: "–°–æ–º–±–æ–ª–∞—Ç",
                                      children: [
                                        {
                                          name: "“ö–æ–∂–∞–∞—Ö–º–µ—Ç",
                                          children: [
                                            {
                                              name: "–ñ–æ–ª–∫–µ–Ω",
                                              children: [
                                                { name: "–ë–∞“õ—ã—Ç –ñ.", children: [] },
                                                {
                                                  name: "–°–µ—Ä—ñ–∫",
                                                  children: [
                                                    {
                                                      name: "–ù“±—Ä–ª–∞–Ω",
                                                      children: [
                                                        { name: "”ò–ª—ñ–±–∏", children: [] },
                                                        { name: "–ñ–∞–Ω–∏—ñ—Å", children: [] }
                                                      ]
                                                    },
                                                    {
                                                      name: "–ï—Ä–ª–∞–Ω",
                                                      children: [
                                                        { name: "–ï—Ä—Å“±–ª—Ç–∞–Ω", children: [] },
                                                        { name: "–ë–∞“õ–±–µ—Ä–≥–µ–Ω", children: [] },
                                                        { name: "–ï—Ä–¥”ô—É–ª–µ—Ç", children: [] },
                                                        { name: "–ó–∞“£“ì–∞—Ä", children: [] }
                                                      ]
                                                    }
                                                  ]
                                                }
                                              ]
                                            }
                                          ]
                                        },
                                        {
                                          name: "–ë–µ–∫–µ—Ç",
                                          children: [
                                            {
                                              name: "–ñ“±–º–∫–µ–Ω",
                                              children: [
                                                { name: "–ë–æ–ª–∞—Ç", children: [] },
                                                { name: "–°–∞–π–ª–∞—É", children: [] },
                                                {
                                                  name: "–ë–µ—Ä—ñ–∫",
                                                  children: [
                                                    {
                                                      name: "–ñ–∞–ª“ì–∞—Å",
                                                      children: [
                                                        { name: "–ñ–∞—Å“±–ª–∞–Ω", children: [] }
                                                      ]
                                                    },
                                                    {
                                                      name: "–¢–∞–ª“ì–∞—Ç",
                                                      children: [
                                                        { name: "”ò–ª–∏—Ö–∞–Ω", children: [] }
                                                      ]
                                                    }
                                                  ]
                                                }
                                              ]
                                            }
                                          ]
                                        }
                                      ]
                                    },
                                    {
                                      name: "–¢–æ–Ω–±–æ–ª–∞—Ç",
                                      children: [{ name: "“ö—ã–∑ –±–∞–ª–∞–ª–∞—Ä", children: [] }]
                                    }
                                  ]
                                }
                              ]
                            }
                          ]
                        },
                        { name: "–ñ–æ–ª–¥—ã–±–µ–∫", children: [] }
                      ]
                    }
                  ]
                },
                { name: "–ö–µ–¥–µ–ª", children: [] },
                { name: "–ö–µ–Ω–∂–µ–±–∞–π", children: [] }
              ]
            }
          ]
        }
      ]
    },
    { name: "–¢–æ—Ä—ã", children: [] },
    { name: "–ë“±–ª—Ç—ã“£", children: [] },
    { name: "–ö”©–ª–¥–µ–Ω–µ“£", children: [] },
    { name: "“ö–∞—Ä–∞–±–∞–ª–∞“õ", children: [] }
  ]
};



        // –î–µ—Ä–µ–∫—Ç–µ—Ä —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞—Å—ã
        let totalAncestors = 0;
        let expandedNodesCount = 0;
        let maxDepth = 0;

        // DOM —ç–ª–µ–º–µ–Ω—Ç—Ç–µ—Ä—ñ –¥–∞–π—ã–Ω –±–æ–ª“ì–∞–Ω–Ω–∞–Ω –∫–µ–π—ñ–Ω —ñ—Å–∫–µ “õ–æ—Å—ã–ª–∞–¥—ã
        document.addEventListener('DOMContentLoaded', function() {
            // –ö—ñ—Ä—É –∞–Ω–∏–º–∞—Ü–∏—è—Å—ã
            const elements = document.querySelectorAll('.fade-in');
            elements.forEach((el, index) => {
                el.style.animationDelay = `${index * 0.2}s`;
            });

            // –ê“ì–∞—à—Ç—ã “õ“±—Ä—É
            buildTree();
            updateStats();
        });

        // –ê“ì–∞—à “õ“±—Ä—É —Ñ—É–Ω–∫—Ü–∏—è—Å—ã
        function buildTree() {
            const treeContainer = document.getElementById('ancestorTree');
            treeContainer.innerHTML = '';
            
            const rootNode = createTreeNode(ancestorData, 0);
            treeContainer.appendChild(rootNode);
        }

        // –ê“ì–∞—à —Ç“Ø–π—ñ–Ω—ñ–Ω “õ“±—Ä—É —Ñ—É–Ω–∫—Ü–∏—è—Å—ã
        function createTreeNode(nodeData, depth) {
            totalAncestors++;
            if (depth > maxDepth) maxDepth = depth;

            const listItem = document.createElement('li');
            listItem.className = 'tree-node';
            
            // –¢–µ—Ä–µ“£–¥—ñ–∫–∫–µ –±–∞–π–ª–∞–Ω—ã—Å—Ç—ã –∫–ª–∞—Å—Å “õ–æ—Å—É
            if (depth === 1) listItem.classList.add('child-node');
            if (depth >= 2) listItem.classList.add('grandchild-node');

            // –ë–∞—Ç—ã—Ä–º–∞ —ç–ª–µ–º–µ–Ω—Ç—ñ–Ω “õ“±—Ä—É
            const button = document.createElement('button');
            button.className = 'ancestor-button';
            
            // + / - –∏–∫–æ–Ω–∫–∞—Å—ã
            const icon = document.createElement('span');
            icon.className = 'toggle-icon';
            icon.textContent = nodeData.children && nodeData.children.length > 0 ? '+' : '‚Ä¢';
            
            // –ê—Ç–∞ –∞—Ç—ã–Ω “õ–æ—Å—É
            const nameSpan = document.createElement('span');
            nameSpan.textContent = nodeData.name;
            
            button.appendChild(icon);
            button.appendChild(nameSpan);
            listItem.appendChild(button);

            // –ë–∞–ª–∞–ø–∞–Ω–¥–∞—Ä –±–∞—Ä –±–æ–ª—Å–∞
            if (nodeData.children && nodeData.children.length > 0) {
                const childList = document.createElement('ul');
                childList.className = 'child-list';

                nodeData.children.forEach(child => {
                    const childNode = createTreeNode(child, depth + 1);
                    childList.appendChild(childNode);
                });

                listItem.appendChild(childList);

                // –ë–∞—Ç—ã—Ä–º–∞“ì–∞ –±–∞—Å“õ–∞–Ω–¥–∞ –∞—à—É/–∂–∞–±—É
                button.addEventListener('click', function() {
                    toggleNode(button, childList);
                });
            }

            return listItem;
        }

        // –¢“Ø–π—ñ–Ω–¥—ñ –∞—à—É/–∂–∞–±—É —Ñ—É–Ω–∫—Ü–∏—è—Å—ã
        function toggleNode(button, childList) {
            const isExpanded = childList.classList.contains('expanded');
            
            if (isExpanded) {
                // –ñ–∞–±—É
                childList.classList.remove('expanded');
                button.classList.remove('expanded');
                button.querySelector('.toggle-icon').textContent = '+';
                expandedNodesCount--;
            } else {
                // –ê—à—É
                childList.classList.add('expanded');
                button.classList.add('expanded');
                button.querySelector('.toggle-icon').textContent = '‚àí';
                expandedNodesCount++;

                // –ê—à—É –∞–Ω–∏–º–∞—Ü–∏—è—Å—ã
                setTimeout(() => {
                    const childButtons = childList.querySelectorAll('.ancestor-button');
                    childButtons.forEach((btn, index) => {
                        btn.style.animation = 'none';
                        setTimeout(() => {
                            btn.style.animation = `fadeInUp 0.4s ease-out forwards`;
                            btn.style.animationDelay = `${index * 0.1}s`;
                        }, 10);
                    });
                }, 100);
            }
            
            updateStats();
        }

        // –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞–Ω—ã –∂–∞“£–∞—Ä—Ç—É —Ñ—É–Ω–∫—Ü–∏—è—Å—ã
        function updateStats() {
            document.querySelector('#totalAncestors span').textContent = totalAncestors;
            document.querySelector('#expandedNodes span').textContent = expandedNodesCount;
            document.querySelector('#treeDepth span').textContent = maxDepth;
        }

        // –ë–∞—Ä–ª—ã“õ —Ç“Ø–π—ñ–Ω–¥–µ—Ä–¥—ñ –∞—à—É
        function expandAll() {
            const allButtons = document.querySelectorAll('.ancestor-button');
            const allChildLists = document.querySelectorAll('.child-list');
            
            expandedNodesCount = 0;
            
            allChildLists.forEach((childList, index) => {
                if (!childList.classList.contains('expanded')) {
                    setTimeout(() => {
                        childList.classList.add('expanded');
                        const button = childList.parentNode.querySelector('.ancestor-button');
                        button.classList.add('expanded');
                        button.querySelector('.toggle-icon').textContent = '‚àí';
                        expandedNodesCount++;
                        updateStats();
                    }, index * 100);
                }
            });
        }

        // –ë–∞—Ä–ª—ã“õ —Ç“Ø–π—ñ–Ω–¥–µ—Ä–¥—ñ –∂–∞–±—É
        function collapseAll() {
            const allChildLists = document.querySelectorAll('.child-list');
            const allButtons = document.querySelectorAll('.ancestor-button');
            
            expandedNodesCount = 0;
            
            allChildLists.forEach(childList => {
                childList.classList.remove('expanded');
                const button = childList.parentNode.querySelector('.ancestor-button');
                button.classList.remove('expanded');
                button.querySelector('.toggle-icon').textContent = '+';
            });
            
            updateStats();
        }

        // –ê“ì–∞—à—Ç—ã “õ–∞–ª–ø—ã–Ω–∞ –∫–µ–ª—Ç—ñ—Ä—É
        function resetTree() {
            totalAncestors = 0;
            expandedNodesCount = 0;
            maxDepth = 0;
            
            collapseAll();
            buildTree();
            updateStats();
            
            // “ö–∞–ª–ø—ã–Ω–∞ –∫–µ–ª—Ç—ñ—Ä—É –∞–Ω–∏–º–∞—Ü–∏—è—Å—ã
            const treeContainer = document.querySelector('.tree-container');
            treeContainer.style.transform = 'scale(0.95)';
            treeContainer.style.opacity = '0.7';
            
            setTimeout(() => {
                treeContainer.style.transform = 'scale(1)';
                treeContainer.style.opacity = '1';
                treeContainer.style.transition = 'all 0.3s ease';
            }, 200);
        }

        // –ö–ª–∞–≤–∏–∞—Ç—É—Ä–∞–ª—ã“õ –Ω–∞–≤–∏–≥–∞—Ü–∏—è “õ–æ–ª–¥–∞—É—ã
        document.addEventListener('keydown', function(e) {
            const focusedButton = document.activeElement;
            
            if (focusedButton && focusedButton.classList.contains('ancestor-button')) {
                // Enter –Ω–µ–º–µ—Å–µ Space –±–∞—Å“õ–∞–Ω–¥–∞
                if (e.key === 'Enter' || e.key === ' ') {
                    e.preventDefault();
                    focusedButton.click();
                }
                
                // –ñ–µ–±–µ –ø–µ—Ä–Ω–µ–ª–µ—Ä—ñ–º–µ–Ω –Ω–∞–≤–∏–≥–∞—Ü–∏—è
                if (e.key === 'ArrowDown') {
                    e.preventDefault();
                    const nextButton = getNextButton(focusedButton);
                    if (nextButton) nextButton.focus();
                }
                
                if (e.key === 'ArrowUp') {
                    e.preventDefault();
                    const prevButton = getPreviousButton(focusedButton);
                    if (prevButton) prevButton.focus();
                }
            }
        });

        // –ö–µ–ª–µ—Å—ñ –±–∞—Ç—ã—Ä–º–∞–Ω—ã —Ç–∞–±—É
        function getNextButton(currentButton) {
            const allButtons = Array.from(document.querySelectorAll('.ancestor-button'));
            const currentIndex = allButtons.indexOf(currentButton);
            return allButtons[currentIndex + 1] || null;
        }

        // –ê–ª–¥—ã“£“ì—ã –±–∞—Ç—ã—Ä–º–∞–Ω—ã —Ç–∞–±—É
        function getPreviousButton(currentButton) {
            const allButtons = Array.from(document.querySelectorAll('.ancestor-button'));
            const currentIndex = allButtons.indexOf(currentButton);
            return allButtons[currentIndex - 1] || null;
        }

        // Accessibility –∞—Ç—Ç—Ä–∏–±—É—Ç—Ç–∞—Ä—ã–Ω –æ—Ä–Ω–∞—Ç—É
        function setupAccessibility() {
            const allButtons = document.querySelectorAll('.ancestor-button');
            
            allButtons.forEach((button, index) => {
                button.setAttribute('tabindex', '0');
                button.setAttribute('role', 'treeitem');
                button.setAttribute('aria-label', 
                    `${button.querySelector('span:last-child').textContent} –∞—Ç–∞—Å—ã`);
                
                const childList = button.parentNode.querySelector('.child-list');
                if (childList) {
                    button.setAttribute('aria-expanded', 'false');
                    childList.setAttribute('role', 'group');
                }
            });
        }

        // –ë–µ—Ç –∂“Ø–∫—Ç–µ–ª–≥–µ–Ω–Ω–µ–Ω –∫–µ–π—ñ–Ω accessibility –æ—Ä–Ω–∞—Ç—É
        window.addEventListener('load', function() {
            setupAccessibility();
            
            // –ê–ª“ì–∞—à“õ—ã —Ñ–æ–∫—É—Å—Ç—ã –æ—Ä–Ω–∞—Ç—É
            const firstButton = document.querySelector('.ancestor-button');
            if (firstButton) {
                firstButton.setAttribute('tabindex', '0');
            }
        });

        // –¢–∞—á—Å–∫—Ä–∏–Ω “õ–æ–ª–¥–∞—É
        let touchStartY = 0;
        let touchEndY = 0;

        document.addEventListener('touchstart', function(e) {
            touchStartY = e.changedTouches[0].screenY;
        });

        document.addEventListener('touchend', function(e) {
            touchEndY = e.changedTouches[0].screenY;
            handleSwipe();
        });

        function handleSwipe() {
            if (touchEndY < touchStartY - 50) {
                // –ñ–æ“ì–∞—Ä—ã —Å–≤–∞–π–ø - –∫–µ–ª–µ—Å—ñ —Ç“Ø–π—ñ–Ω–≥–µ ”©—Ç—É
                const focusedButton = document.activeElement;
                if (focusedButton && focusedButton.classList.contains('ancestor-button')) {
                    const nextButton = getNextButton(focusedButton);
                    if (nextButton) nextButton.focus();
                }
            }
            
            if (touchEndY > touchStartY + 50) {
                // –¢”©–º–µ–Ω —Å–≤–∞–π–ø - –∞–ª–¥—ã“£“ì—ã —Ç“Ø–π—ñ–Ω–≥–µ ”©—Ç—É
                const focusedButton = document.activeElement;
                if (focusedButton && focusedButton.classList.contains('ancestor-button')) {
                    const prevButton = getPreviousButton(focusedButton);
                    if (prevButton) prevButton.focus();
                }
            }
        }
    </script>
</body>
</html>